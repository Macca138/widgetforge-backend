<!DOCTYPE html>
<html>
<head>
  <title>WidgetForge: Ticker Builder</title>
  <style>
    body { font-family: Inter, sans-serif; padding: 2em; max-width: 700px; margin: auto; background: #f8f8f8; }
    label { display: block; margin-top: 1em; font-weight: 600; }
    input, select { width: 100%; padding: 8px; font-size: 14px; }
    .preview-box { border: 1px solid #ccc; padding: 10px; margin-top: 2em; background: white; }
    .iframe-box { background: #eef; padding: 10px; margin-top: 1em; font-family: monospace; }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Inter&family=Roboto&family=Open+Sans&family=Lato&family=Montserrat&family=Oswald&family=Source+Sans+Pro&display=swap" rel="stylesheet">
</head>
<body>
  <h1>üéõÔ∏è Build Your Live Ticker Widget</h1>

  <form id="configForm">
    <label>Choose Assets</label>
    <select id="symbols" multiple size="20">
  <!-- Options will load here -->
</select>

    <label>Font</label>
    <select id="font">
      <option>Inter</option>
      <option>Roboto</option>
      <option>Open Sans</option>
      <option>Lato</option>
      <option>Montserrat</option>
      <option>Oswald</option>
      <option>Source Sans Pro</option>
      <option>Courier New</option>
    </select>

    <label>Font Size (px)</label>
    <input type="number" id="fontSize" value="16">

    <label>Font Color</label>
    <input type="color" id="fontColor" value="#ffffff">

    <label>Background Color</label>
    <input type="color" id="bgColor" value="#000000">

    <label>Scroll Speed (ms per full scroll)</label>
    <input type="number" id="scrollSpeed" value="30">

    <label>Static Text</label>
    <input type="text" id="staticText" placeholder="e.g. The best spreads in the prop space">

    <label>Widget Width (px)</label>
    <input type="number" id="widgetWidth" value="1200">

    <label>Widget Height (px)</label>
    <input type="number" id="widgetHeight" value="60">

    <label>Show 5ers Logo?</label>
    <select id="showLogo">
      <option value="true">Yes</option>
      <option value="false">No</option>
    </select>

    <button type="submit" style="margin-top:2em;">Generate Widget</button>
  </form>

  <div class="preview-box" id="previewBox" style="display:none;">
    <h3>üîó Your Embed Code</h3>
    <div class="iframe-box">
      <code id="iframeCode"></code>
    </div>
    <h3>üëÄ Live Preview</h3>
    <iframe id="previewFrame" width="100%" height="100" style="border:none;"></iframe>
  </div>

  <script>
    document.getElementById('configForm').onsubmit = function(e) {
      e.preventDefault();
      const symbols = Array.from(document.getElementById('symbols').selectedOptions).map(opt => opt.value).join(',');
      const font = document.getElementById('font').value;
      const fontSize = document.getElementById('fontSize').value;
      const fontColor = document.getElementById('fontColor').value;
      const bgColor = document.getElementById('bgColor').value;
      const scrollSpeed = document.getElementById('scrollSpeed').value;
      const staticText = document.getElementById('staticText').value;
      const widgetWidth = document.getElementById('widgetWidth').value;
      const widgetHeight = document.getElementById('widgetHeight').value;
      const showLogo = document.getElementById('showLogo').value;

      const params = new URLSearchParams({
        symbols, font, fontSize, fontColor, bgColor, scrollSpeed, staticText, showLogo
      });

      const src = `http://62.171.135.138:8000/widgets/ticker?${params.toString()}`;
      const iframeHTML = `<iframe src="${src}" width="${widgetWidth}" height="${widgetHeight}" frameborder="0"></iframe>`;

      document.getElementById('iframeCode').textContent = iframeHTML;
      document.getElementById('previewFrame').src = src;
      document.getElementById('previewFrame').width = widgetWidth;
      document.getElementById('previewFrame').height = widgetHeight;
      document.getElementById('previewBox').style.display = 'block';
    };
  </script>
  
  <script>
  window.onload = function () {
    fetch("/assets")
      .then(response => response.text())
      .then(html => {
        document.getElementById("symbols").innerHTML = html;
      });
  };
</script>

</body>
</html>
